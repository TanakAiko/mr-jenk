<div class="container mx-auto px-4 py-8">
  <h2 class="text-2xl font-bold mb-6">Seller Orders</h2>

  <div *ngIf="loading" class="text-center py-8">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"></div>
    <p class="mt-4 text-gray-600">Loading orders...</p>
  </div>

  <div *ngIf="error" class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-6">
    {{ error }}
  </div>

  <div *ngIf="!loading && !error && orders.length === 0" class="text-center py-12 bg-gray-50 rounded-lg">
    <p class="text-gray-500 text-lg">No orders found.</p>
  </div>

  <div *ngIf="!loading && orders.length > 0" class="space-y-6">
    <div *ngFor="let order of orders" class="bg-white shadow rounded-lg overflow-hidden border border-gray-200">
      <!-- Order Header -->
      <div class="bg-gray-50 px-6 py-4 border-b border-gray-200 flex justify-between items-center flex-wrap gap-4">
        <div>
          <p class="text-sm text-gray-500">Order ID</p>
          <p class="font-mono font-medium text-gray-900">{{ order.id }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500">Date</p>
          <p class="font-medium text-gray-900">{{ order.createdAt | date:'medium' }}</p>
        </div>
        <div>
          <p class="text-sm text-gray-500">Total (Your Items)</p>
          <p class="font-medium text-blue-600">{{ order.totalPrice | currency }}</p>
        </div>
        <div>
          <span class="px-3 py-1 rounded-full text-xs font-medium"
                [ngClass]="{
                  'bg-yellow-100 text-yellow-800': order.status === 'PENDING',
                  'bg-green-100 text-green-800': order.status === 'CONFIRMED' || order.status === 'DELIVERED',
                  'bg-blue-100 text-blue-800': order.status === 'SHIPPED',
                  'bg-red-100 text-red-800': order.status === 'CANCELLED'
                }">
            {{ order.status }}
          </span>
        </div>
      </div>

      <!-- Order Items -->
      <div class="divide-y divide-gray-200">
        <div *ngFor="let item of order.items" class="p-6 flex flex-col sm:flex-row items-start sm:items-center gap-6">
          <!-- Product Image -->
          <div class="h-20 w-20 flex-shrink-0 overflow-hidden rounded-md border border-gray-200">
            <img [src]="item.imageUrl || 'assets/images/placeholder.png'" 
                 [alt]="item.productName"
                 class="h-full w-full object-cover object-center">
          </div>

          <!-- Product Details -->
          <div class="flex-1">
            <h3 class="text-base font-medium text-gray-900">{{ item.productName }}</h3>
            <p class="mt-1 text-sm text-gray-500">Quantity: {{ item.quantity }}</p>
            <p class="mt-1 text-sm font-medium text-gray-900">{{ item.unitPrice | currency }} each</p>
          </div>

          <!-- Status Management -->
          <div class="flex flex-col gap-2 min-w-[200px]">
            <label class="text-xs font-medium text-gray-700">Item Status</label>
            <select 
              [ngModel]="item.status" 
              (ngModelChange)="updateStatus(order.id, item, $event)"
              class="block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring-blue-500 sm:text-sm p-2 border"
              [disabled]="order.status === 'CANCELLED'">
              <option *ngFor="let status of orderStatuses" [value]="status">
                {{ status }}
              </option>
            </select>
          </div>
          
          <!-- Subtotal -->
          <div class="text-right min-w-[100px]">
            <p class="text-sm text-gray-500">Subtotal</p>
            <p class="text-lg font-medium text-gray-900">{{ item.subtotal | currency }}</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
